action:
  - choose:
      - conditions:
          - condition: template
            value_template: '{{ is_state(trigger.to_state.entity_id, "on") }}'
        sequence:
          - service: light.turn_on
            data:
              brightness: '{{ state_attr(trigger.to_state.entity_id, "brightness") }}'
              color_temp: >
                {% if trigger.to_state.attributes.color_temp is defined %}
                  {{ trigger.to_state.attributes.color_temp }}
                {% else %}
                  {{ state_attr(trigger.to_state.entity_id, "color_temp") }}
                {% endif %}
            target:
              entity_id: >
                {% if trigger.from_state.entity_id == entity_1 %} {{ entity_2 }}
                {% elif trigger.from_state.entity_id == entity_2 %} {{ entity_3 }}
                {% else %} {{ entity_1 }} {% endif %}
      - conditions:
          - condition: template
            value_template: '{{ is_state(trigger.to_state.entity_id, "off") }}'
        sequence:
          - service: light.turn_off
            target:
              entity_id: >
                {% if trigger.from_state.entity_id == entity_1 %} {{ entity_2 }}
                {% elif trigger.from_state.entity_id == entity_2 %} {{ entity_3 }}
                {% else %} {{ entity_1 }} {% endif %}
